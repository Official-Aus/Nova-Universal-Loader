local Rayfield = loadstring(game:HttpGet("https://sirius.menu/rayfield"))()

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Camera = workspace.CurrentCamera
local LocalPlayer = Players.LocalPlayer

-- ===================== RIVALS =====================
if game.PlaceId == 17625359962 then
    local Window = Rayfield:CreateWindow({
        Name = "NovaX Rivals",
        Icon = 0,
        LoadingTitle = "NovaX Loader",
        LoadingSubtitle = "by Aus",
        ShowText = "NovaX",
        Theme = "Default",
        ToggleUIKeybind = "K",

        ConfigurationSaving = {
            Enabled = true,
            FolderName = "NovaX",
            FileName = "Rivals"
        },

        Discord = { Enabled = false },
        KeySystem = false
    })

    local ESP = {
        Boxes = false,
        Skeleton = false,
        Tracers = false,
        Healthbar = false
    }

    local Drawings = {}

    -- ================== DRAWING HELPERS ==================
    local function NewDraw(type, props)
        local d = Drawing.new(type)
        for i,v in pairs(props) do
            d[i] = v
        end
        return d
    end

    local function RemoveESP(plr)
        if Drawings[plr] then
            for _,obj in pairs(Drawings[plr]) do
                if typeof(obj) == "table" then
                    for _,l in pairs(obj) do l:Remove() end
                else
                    obj:Remove()
                end
            end
            Drawings[plr] = nil
        end
    end

    local function CreateESP(plr)
        Drawings[plr] = {
            Box = NewDraw("Square",{Thickness=1,Filled=false,Color=Color3.new(1,1,1)}),
            Tracer = NewDraw("Line",{Thickness=1,Color=Color3.new(1,1,1)}),
            HealthBG = NewDraw("Line",{Thickness=3,Color=Color3.fromRGB(60,60,60)}),
            Health = NewDraw("Line",{Thickness=3,Color=Color3.fromRGB(0,255,0)}),
            Skeleton = {}
        }
    end

    -- ================== SKELETON BONES ==================
    local Bones = {
        {"Head","UpperTorso"},
        {"UpperTorso","LowerTorso"},
        {"UpperTorso","LeftUpperArm"},
        {"LeftUpperArm","LeftLowerArm"},
        {"LeftLowerArm","LeftHand"},
        {"UpperTorso","RightUpperArm"},
        {"RightUpperArm","RightLowerArm"},
        {"RightLowerArm","RightHand"},
        {"LowerTorso","LeftUpperLeg"},
        {"LeftUpperLeg","LeftLowerLeg"},
        {"LeftLowerLeg","LeftFoot"},
        {"LowerTorso","RightUpperLeg"},
        {"RightUpperLeg","RightLowerLeg"},
        {"RightLowerLeg","RightFoot"}
    }

    -- ================== MAIN LOOP ==================
    RunService.RenderStepped:Connect(function()
        for _,plr in pairs(Players:GetPlayers()) do
            if plr ~= LocalPlayer and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
                if not Drawings[plr] then
                    CreateESP(plr)
                end

                local char = plr.Character
                local hrp = char.HumanoidRootPart
                local hum = char:FindFirstChildOfClass("Humanoid")

                local pos, onScreen = Camera:WorldToViewportPoint(hrp.Position)
                if not onScreen then
                    RemoveESP(plr)
                    continue
                end

                local scale = 1 / pos.Z
                local size = Vector2.new(2200 * scale, 3000 * scale)
                local boxPos = Vector2.new(pos.X - size.X/2, pos.Y - size.Y/2)

                -- BOX
                local box = Drawings[plr].Box
                box.Visible = ESP.Boxes
                box.Size = size
                box.Position = boxPos

                -- TRACER
                local tracer = Drawings[plr].Tracer
                tracer.Visible = ESP.Tracers
                tracer.From = Vector2.new(Camera.ViewportSize.X/2, Camera.ViewportSize.Y)
                tracer.To = Vector2.new(pos.X, pos.Y)

                -- HEALTHBAR
                local hbBG = Drawings[plr].HealthBG
                local hb = Drawings[plr].Health
                if ESP.Healthbar and hum then
                    local hp = hum.Health / hum.MaxHealth
                    hbBG.Visible = true
                    hb.Visible = true

                    hbBG.From = Vector2.new(boxPos.X - 6, boxPos.Y)
                    hbBG.To = Vector2.new(boxPos.X - 6, boxPos.Y + size.Y)

                    hb.From = Vector2.new(boxPos.X - 6, boxPos.Y + size.Y)
                    hb.To = Vector2.new(boxPos.X - 6, boxPos.Y + size.Y * (1 - hp))
                else
                    hbBG.Visible = false
                    hb.Visible = false
                end

                -- SKELETON
                for _,line in pairs(Drawings[plr].Skeleton) do
                    line:Remove()
                end
                Drawings[plr].Skeleton = {}

                if ESP.Skeleton then
                    for _,bone in pairs(Bones) do
                        local p1 = char:FindFirstChild(bone[1])
                        local p2 = char:FindFirstChild(bone[2])
                        if p1 and p2 then
                            local s1, v1 = Camera:WorldToViewportPoint(p1.Position)
                            local s2, v2 = Camera:WorldToViewportPoint(p2.Position)
                            if v1 and v2 then
                                local l = NewDraw("Line",{
                                    Thickness = 1,
                                    Color = Color3.new(1,1,1),
                                    From = Vector2.new(s1.X,s1.Y),
                                    To = Vector2.new(s2.X,s2.Y)
                                })
                                table.insert(Drawings[plr].Skeleton, l)
                            end
                        end
                    end
                end
            else
                RemoveESP(plr)
            end
        end
    end)



    -- Tabs
    local MainTab = Window:CreateTab("Main", 4483362458)
    local VisualTab = Window:CreateTab("Visuals", 4483362458)
    local OtherTab = Window:CreateTab("Other Menu", 4483362458)
    local SettingsTab = Window:CreateTab("Settings", 4483362458)


    -- Visuals
    VisualTab:CreateToggle({
        Name = "2D Box",
        Callback = function
    })

    -- Other Menu Buttons
    OtherTab:CreateButton({
        Name = "Z3US",
        Callback = function()
            loadstring(game:HttpGet(
                "https://raw.githubusercontent.com/blackowl1231/Z3US/refs/heads/main/Games/Z3US%20Rivals%20Beta.lua"
            ))()
        end
    })
end

-- ===================== BEDWARS =====================
if game.PlaceId == 6872265039 then
    local Window = Rayfield:CreateWindow({
        Name = "NovaX BedWars",
        Icon = 0,
        LoadingTitle = "NovaX Loader",
        LoadingSubtitle = "by Aus",
        ShowText = "NovaX",
        Theme = "Default",
        ToggleUIKeybind = "K",

        ConfigurationSaving = {
            Enabled = true,
            FolderName = "NovaX",
            FileName = "BedWars"
        },

        Discord = { Enabled = false },
        KeySystem = false
    })

    local MainTab = Window:CreateTab("Main", 4483362458)
end
